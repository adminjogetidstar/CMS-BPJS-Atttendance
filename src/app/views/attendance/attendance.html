<div class="card-container d-flex flex-column">
    <span class="text-idstar-red fs-5 fw-bold text-nowrap">Absensi Karyawan</span>
    <div class="d-flex align-items-center gap-3 mt-3 flex-wrap">
        <input type="text" [(ngModel)]="searchKeyword" (ngModelChange)="applyFilter()" class="form-control w-auto"
            placeholder="Cari nama karyawan..." />
        <select [(ngModel)]="filterStatus" (ngModelChange)="applyFilter()" class="form-select w-auto">
            <option value="Semua">Semua Status</option>
            <option value="Hadir">Hadir</option>
            <option value="Izin">Izin</option>
            <option value="Sakit">Sakit</option>
        </select>
        <button class="btn-idstar btn-idstar-outline ms-auto d-flex align-items-center" (click)="openCreateModal()">
            <img src="assets/icons/plus-circle.svg" class="me-2" style="width: 30px; height: 30px" />
            Tambah Absensi
        </button>
    </div>
    <ng-container *ngIf="!(loading$ | async)">
        <ng-container *ngIf="paginatedData.length; else emptyState">
            <app-custom-table class="mt-3" [tableData]="paginatedData" [tableConfigs]="tableConfigs"
                (onActionClick)="actionRecord($event)">
            </app-custom-table>
            <app-pagination [totalRecord]="filteredData.length" [itemsPerPage]="itemsPerPage"
                [currentPage]="currentPage" (pageSize)="onPageSizeChange($event)" (activePage)="onPageChange($event)">
            </app-pagination>
        </ng-container>
    </ng-container>
    <ng-template #emptyState>
        <div class="d-flex flex-column justify-content-center align-items-center mt-5 p-4">
            <img src="assets/icons/not found.svg" alt="No Data" style="max-width: 250px" />
        </div>
    </ng-template>
</div>

<app-attendance-form *ngIf="showModal" [visible]="showModal" [mode]="modalMode" [record]="selectedRecord"
    (close)="closeModal()" (save)="saveRecord($event)">
</app-attendance-form>

<!-- Modal Konfirmasi Delete -->
<div class="modal fade show d-block" tabindex="-1" *ngIf="confirmDeleteVisible"
    style="background-color: rgba(0,0,0,0.5)">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-3 shadow-lg">
            <div class="modal-header text-white">
                <h5 class="modal-title fw-bold text-idstar-red">Konfirmasi Hapus</h5>
                <button type="button" class="btn-close" (click)="closeConfirmModal()"></button>
            </div>
            <div class="modal-body">
                <p>
                    Apakah Anda yakin ingin menghapus data absensi
                    <strong>{{ recordToDelete?.employeeName }}</strong>?
                </p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" (click)="closeConfirmModal()">Batal</button>
                <button class="btn btn-danger" (click)="confirmDelete()">Hapus</button>
            </div>
        </div>
    </div>
</div>